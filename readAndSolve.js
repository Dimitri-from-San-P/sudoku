// ะะพะดะบะปััะธัั ััะฝะบัะธะธ ะธะท ัะฐะนะปะฐ sudoku.js.
const sudoku = require('./sudoku');

function readAndSolve(error, fileData) {
  // ะัะปะธ ััะตะฝะธะต ัะฐะนะปะฐ ะฝะต ัะดะฐะปะพัั, ะฒัะฑัะพัะธัั ะพัะธะฑะบั ั ะพะฟะธัะฐะฝะธะตะผ ะฟัะพะฑะปะตะผั ะธ
  // ะทะฐะฒะตััะธัั ัะฐะฑะพัั ััะฝะบัะธะธ.
  if (error) {
    throw error;
  }

  // ะะฐะทะฑะธัั ัะพะดะตัะถะธะผะพะต ัะฐะนะปะฐ ะฟะพัััะพัะฝะพ ะธ ะพััะธะปัััะพะฒะฐัั ะฒัะต ะฟััััะต ัััะพะบะธ.
  const puzzles = fileData
    .split('\n')
    .filter((line) => line !== '');

  // ะะพะปััะธัั ะฝะพะผะตั ััะดะพะบั ะธะท process.argv, ะปะธะฑะพ ะฒะทััั 1-ะน ััะดะพะบั ะฟะพ ัะผะพะปัะฐะฝะธั.
  let puzzleNumber = Number(process.argv[2]) || 1;

  // ะะณัะฐะฝะธัะธัั ะฝะพะผะตั ััะดะพะบั ะผะฐะบัะธะผะฐะปัะฝัะผ ัะธัะปะพะผ ะผะฐััะธะฒะฐ ั ะฟะฐะทะทะปะฐะผะธ.
  if (puzzleNumber > puzzles.length) {
    puzzleNumber = puzzles.length;
  }

  // ะะพะปััะธัั ะถะตะปะฐะตะผัะน ััะดะพะบั ะฟะพ ะธะฝะดะตะบัั ะธ ะฒัะฒะตััะธ ะตะณะพ ะฒ ะบะพะฝัะพะปั..
  const puzzle = puzzles[puzzleNumber - 1];
  console.log('\n',`แแแฏแฃแแฐ แแฝแชแแฆแฝ โ${puzzleNumber}:`, '\n');
  console.log(puzzle, '\n');

  // ะัะฟะพะปัะทะพะฒะฐัั ััะฝะบัะธั solve ะธะท ัะฐะนะปะฐ sudoku.js ะดะปั ัะตัะตะฝะธั ััะดะพะบั.
  const solvedPuzzle = sudoku.solve(puzzle);

  // ะัะฟะพะปัะทะพะฒะฐัั ััะฝะบัะธั isSolved ะธะท ัะฐะนะปะฐ sudoku.js ะดะปั ะฟัะพะฒะตัะบะธ ัะตัะตะฝะธั ััะดะพะบั.
  if (!sudoku.isSolved(solvedPuzzle)) {
    console.log(`แผแ แแฐแแแแ แแแฏแแขแ แแฝแชแแฆแฝ โ${puzzleNumber} ๐คฌ๐คฌ๐คฌ๐ค`, '\n');
    return; // ะัะปะธ ััะดะพะบั ะฝะต ัะตััะฝ, ะทะฐะฒะตััะธัั ัะฐะฑะพัั ััะพะน ััะฝะบัะธะธ.
  }

  // ะะพะด ะฝะธะถะต ััะฐะฑะพัะฐะตั, ัะพะปัะบะพ ะตัะปะธ ะฟัะพะฒะตัะบะฐ ัะตัะตะฝะธั ััะดะพะบั ะฟัะพัะปะฐ ััะฟะตัะฝะพ.
  console.log(`แแฝแชแแฆแฝ โ${puzzleNumber} ัแแแฏแงแผ แฝแแแแฏแผแ! ๐๐๐`, '\n');

  // ะัะฟะพะปัะทะพะฒะฐัั ััะฝะบัะธั prettyBoard ะธะท ัะฐะนะปะฐ sudoku.js ะดะปั ัะพัะผะฐัะธัะพะฒะฐะฝะธั
  // ะธะณัะพะฒะพะณะพ ะฟะพะปั ะฒ ัััะพะบั ะฒ ะถะตะปะฐะตะผะพะผ ัะพัะผะฐัะต.
  
  // console.log(sudoku.prettyBoard(solvedPuzzle), '\n');
  sudoku.prettyBoard(solvedPuzzle)
}

module.exports = readAndSolve;
